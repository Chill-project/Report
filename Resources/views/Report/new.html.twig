{#
 * Copyright (C) 2014, Champs Libres Cooperative SCRLFS, <http://www.champs-libres.coop>
 * 
 * This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 *  License, or (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 * 
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}
{% extends "ChillPersonBundle::layout.html.twig"  %}

{% set activeRouteKey = 'report_select_type' %}

{% block title %}{{ 'Add a report'|trans }}{% endblock title %}

{% block personcontent %}
    {{ form_start(form) }}

    {{ form_widget(form) }}
        <div class="grid-12 centered sticky-form-buttons">
            <button class="sc-button green" type="submit"><i class="fa fa-save"></i> {{ 'Add report'|trans }}</button>
            <button class="sc-button red" type="reset"><i class="fa fa-eraser"></i> {{ 'Reset report'|trans }}</button>
        </div>
    {{ form_end(form) }}
 <script type="text/javascript">
var form = $("form[name='{{ form.vars.form.vars.name }}']").data('serialize',$("form[name='{{ form.vars.form.vars.name }}']").serialize());
// On load save form current state
var submittedOk{{ form.vars.form.vars.name }} = false;
form.bind('submit', function(e) {
    submittedOk{{ form.vars.form.vars.name }} = true;
});

$(window).bind('beforeunload', function(e){
    if($("form[name='{{ form.vars.form.vars.name }}']").serialize()!=$("form[name='{{ form.vars.form.vars.name }}']").data('serialize')){
        if (submittedOk{{ form.vars.form.vars.name }} == false) {
            return "{{ 'You are going to leave a page with unsubmitted data. Are you sure you want to leave ?'|trans }}";
            }
        }
    e=null;
    // i.e; if form state change show box not.
});
</script>
{% endblock %}